!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).cubeSolver=n()}(this,function(){"use strict";function u(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}function n(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)}return t}function c(o){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach(function(e){var n,t,r;n=o,r=i[t=e],t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach(function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(i,e))})}return o}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function t(e,n){return(t=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e})(e,n)}function f(e,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function h(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var t=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(t.push(a.value),!n||t.length!==n);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return t}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function b(e){return 0===e||1===e?1:(0<ae[e]||(ae[e]=b(e-1)*e),ae[e])}function p(e,n){if(e<n)return 0;for(;e>=ue.length;){for(var t=ue.length,r=[],o=r[0]=1,i=t-1;o<t;o+=1)r[o]=ue[i][o-1]+ue[i][o];r[t]=1,ue.push(r)}return ue[e][n]}function i(e,n){return Math.floor(Math.random()*(n-e+1))+e}function s(e,n){var t=e.slice(0);t[n[0]]=e[n[n.length-1]];for(var r=1;r<n.length;r+=1)t[n[r]]=e[n[r-1]];return t}function v(e,n,t){for(var r=e[n],o=n;o<t;o+=1)e[o]=e[o+1];e[t]=r}function y(e,n,t){for(var r=e[t],o=t;n<o;--o)e[o]=e[o-1];e[n]=r}function o(e,n){for(var t=0,r=0;r<e.length-1;r+=1)t=n*t+e[r];return t}function l(e,n,t){for(var r=[],o=0,i=n-2;0<=i;--i){var a=e%t;e=Math.floor(e/t),o+=r[i]=a}return r[n-1]=(t-o%t)%t,r}function d(e){for(var n=0,t=e.length-1;0<t;--t)for(var r=t-1;0<=r;--r)e[r]>e[t]&&(n+=1);return n%2}function m(e,n,t){var r=2<arguments.length&&void 0!==t&&t,o=e.length-1,i=0,a=1,u=[];if(r)for(var f=e.length-1;0<=f;--f)0<=n.indexOf(e[f])&&(o=Math.min(o,e[f]),i+=p(e.length-1-f,a),u.unshift(e[f]),a+=1);else for(var s=0;s<e.length;s+=1)0<=n.indexOf(e[s])&&(o=Math.min(o,e[s]),i+=p(s,a),u.push(e[s]),a+=1);for(var l=0,c=u.length-1;0<c;--c){for(var h=0;u[c]!==n[c];)v(u,0,c),h+=1;l=(c+1)*l+h}return b(n.length)*i+l}function g(e,n,t,r){for(var o=3<arguments.length&&void 0!==r&&r,i=b(n.length),a=Math.floor(e/i),u=e%i,f=[],s=0;s<t;s+=1)f.push(-1);for(var l=1;l<n.length;l+=1){var c=u%(l+1);for(u=Math.floor(u/(l+1));0<c;)y(n,0,l),--c}var h=n.length-1;if(o)for(var v=0;v<t;v+=1){var d=p(t-1-v,h+1);0<=a-d&&(f[v]=n[n.length-1-h],a-=d,--h)}else for(var m=t-1;0<=m;--m){var g=p(m,h+1);0<=a-g&&(f[m]=n[h],a-=g,--h)}return f}function x(e){return/^([FRUBLDfrubldxyzMSE][2']?\s*)+$/.test(e)}function T(e,n){var t=1<arguments.length&&void 0!==n&&n;if(!x(e))throw new Error("Invalid algorithm provided to algorithm parser");var r=[],o=h(function(o){o=o.reduce(function(e,n){var t=n.charAt(0),r=n.charAt(1);return se[t]?e.concat(se[t].map(function(e){return e+r})):e.concat(n)},[]);for(var i=[],a=[],e=function(e){var n=o[e].charAt(0),t=fe[o[e].charAt(1)];if("xyz".includes(n)){a.unshift(o[e]);for(var r=0;r<=t;r+=1)i=i.map(function(e){return le[n]["FRUBLD".indexOf(e[0])]+e.charAt(1)})}else i.unshift(o[e])},n=o.length-1;0<=n;--n)e(n);return[i,a]}(e.match(/[FRUBLDfrubldxyzMSE][2']?/g)),2),i=o[0],a=o[1];return i.forEach(function(e){var n="FRUBLD".indexOf(e.charAt(0)),t=fe[e.charAt(1)];r.push(3*n+t)}),t?[r,a]:r}function O(e){var n="";return e.forEach(function(e){switch(n+=" ",n+="FRUBLD".charAt(Math.floor(e/3)),e%3){case 1:n+="2";break;case 2:n+="'"}}),n.trim()}function w(e,n,t){for(var r=e,o=t[Math.floor(n/3)],i=n%3,a=0;a<=i;a+=1)r=s(r,o);return r}function P(e,n){return w(e,n,we)}function M(e,n){return w(e,n,Pe)}function z(e,n){var t=Math.floor(n/3),r=we[t],o=n%3,i=P(e,n);if((0===t||3===t)&&o%2==0)for(var a=0;a<4;a+=1)i[r[a]]=(i[r[a]]+1)%2;return i}function E(e,n){var t=Math.floor(n/3),r=Pe[t],o=n%3,i=M(e,n);if(2!==t&&5!==t&&o%2==0)for(var a=0;a<4;a+=1)i[r[a]]=(i[r[a]]+(a+1)%2+1)%3;return i}function D(n){return new ze({name:n.name,moves:n.moves,defaultIndex:m([0,1,2,3,4,5,6,7],n.affected,n.reversed),size:n.size||b(8)/b(8-n.affected.length),getVector:function(e){return g(e,n.affected.slice(),8,n.reversed)},cubieMove:M,getIndex:function(e){return m(e,n.affected,n.reversed)}})}function j(n){return new ze({name:n.name,moves:n.moves,defaultIndex:m([0,1,2,3,4,5,6,7,8,9,10,11],n.affected,n.reversed),size:n.size||b(12)/b(12-n.affected.length),getVector:function(e){return g(e,n.affected.slice(),12,n.reversed)},cubieMove:P,getIndex:function(e){return m(e,n.affected,n.reversed)}})}function I(t,r,o){for(var i=[],e=Math.pow(o,r-1),n=Math.pow(o,r-t.length-1),a=function(e){var n=l(e,r,o);t.every(function(e){return 0===n[e]})&&i.push(e)},u=0;u<e&&i.length<n;u+=1)a(u);return i}function C(e){return new ze({name:e.name,size:2048,solvedIndexes:I(e.affected,12,2),getVector:function(e){return l(e,12,2)},cubieMove:z,getIndex:function(e){return o(e,2)}})}function F(e){return new ze({name:e.name,size:2187,solvedIndexes:I(e.affected,8,3),getVector:function(e){return l(e,8,3)},cubieMove:E,getIndex:function(e){return o(e,3)}})}function U(e){return je.solve({scramble:e})}function k(e){return Ie.solve({scramble:e})}function A(e){return Ce.solve({scramble:e})}function R(e,n){var t=1<arguments.length&&void 0!==n?n:22;return Array.isArray(e)?ke.solve({indexes:e,maxDepth:t}):ke.solve({scramble:e,maxDepth:t})}function S(e,n,t,r){return R([Math.floor(m(n,[8,9,10,11],!0)/24),o(t,3),o(e,2),m(n,[8,9,10,11],!0),d(r),m(r,[0,1,2,3,4,5]),m(n,[0,1,2]),m(n,[3,4,5])])}function L(e){return Ae.solve({scramble:e})}function V(e){return Re.solve({scramble:e})}function B(e){return Se.solve({scramble:e})}function _(e){return Le.solve({scramble:e})}function $(e,n,t){var r=l(i(0,Math.pow(n,e.length-1)),e.length,n),o=Array(t).fill(0);return e.forEach(function(e,n){o[e]=r[n]}),o}function q(e,n){var t=g(i(0,b(e.length)),e.slice(0),e.length),r=[0,1,2,3,4,5,6,7,8,9,10,11].slice(0,n);return e.forEach(function(e,n){r[e]=t[n]}),r}function G(e,n){n=n||i(0,4);for(var t=0;t<n;t+=1)e=s(e,Ve);return e}function H(e,n,t,r,o,i){for(var a,u,f,s,l=2<arguments.length&&void 0!==t?t:e,c=3<arguments.length&&void 0!==r?r:n,h=4<arguments.length&&void 0!==o&&o,v=5<arguments.length&&void 0!==i&&i;a=$(l,2,12),u=q(e,12),h&&(u=G(u)),f=$(c,3,8),s=q(n,8),v&&(s=G(s)),d(u)!==d(s););return S(a,u,f,s)}function J(){return H([ce,he,ve,de],[],[],[pe,ye,xe,Te],!1,!0)}function K(){for(var e,n,t,r;e=l(i(0,2048),12,2),t=l(i(0,2187),8,3),n=g(i(0,479001600),[0,1,2,3,4,5,6,7,8,9,10,11],12),r=g(i(0,40320),[0,1,2,3,4,5,6,7],8),d(n)!==d(r););return S(e,n,t,r)}function N(){return H([ce,he,ve,de,me,ge],[pe,ye,xe,Te])}function Q(){return H([],[0,1,2,3,4,5,6,7])}function W(){return H([0,1,2,3,4,5,6,7,8,9,10,11],[])}function X(){return H(Be,[],Be,[],!1,!0)}function Y(){return H([ce,he,ve,de,be],[pe,ye,xe,Te,Oe])}function Z(){return H([ce,he,ve,de],[pe,ye,xe,Te],[],[])}function ee(){return H(_e,$e,[],$e)}function ne(){return H([ce,he,ve,de,be],qe,[],qe)}var te,re,oe,ie,ae=[],ue=[],fe={"":0,2:1,"'":2},se={f:["z","B"],r:["x","L"],u:["y","D"],b:["z'","F"],l:["x'","R"],d:["y'","U"],M:["x'","R","L'"],S:["z","F'","B"],E:["y'","U","D'"]},le={x:"DRFULB",y:"RBULFD",z:"FULBDR"},ce=0,he=1,ve=2,de=3,me=5,ge=7,be=8,pe=0,ye=1,xe=2,Te=3,Oe=4,we=[[1,8,5,9],[0,11,4,8],[1,2,3,0],[3,10,7,11],[2,9,6,10],[5,4,7,6]],Pe=[[1,0,4,5],[0,3,7,4],[0,1,2,3],[3,2,6,7],[2,1,5,6],[5,4,7,6]],Me=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17],ze=function(){function n(t){var r=this;if(u(this,n),this.name=t.name,this.size=t.size,this.defaultIndex=t.defaultIndex||0,this.solvedIndexes=t.solvedIndexes||[this.defaultIndex],t.doMove&&(this.doMove=function(e,n){return t.doMove(r.table,e,n)}),t.table)this.table=t.table;else{var o,i,a,e=(o=t.getVector,i=t.cubieMove,a=t.getIndex,function(e,n){var t=o(e);return t=i(t,n),a(t)});this.createMoveTable(t.size,e,t.moves)}}return e(n,[{key:"doMove",value:function(e,n){return this.table[e][n]}},{key:"createMoveTable",value:function(e,n,t){var r=2<arguments.length&&void 0!==t?t:Me;this.table=[];for(var o=0;o<e;o+=1)this.table.push([]);for(var i=0;i<e;i+=1)for(var a=0;a<r.length;a+=1){var u=r[a];if(!this.table[i][u]){var f=n(i,u),s=u-u%3*2+2;this.table[i][u]=f,this.table[f][s]=i}}}}]),n}(),Ee=function(){function t(e,n){u(this,t),this.computePruningTable(e,n)}return e(t,[{key:"setPruningValue",value:function(e,n){this.table[e>>3]^=(15^n)<<((7&e)<<2)}},{key:"getPruningValue",value:function(e){return this.table[e>>3]>>((7&e)<<2)&15}},{key:"computePruningTable",value:function(e,n){var t=e.reduce(function(e,n){return e*n.size},1);this.table=[];for(var r=0;r<t+7>>3;r+=1)this.table.push(-1);for(var o=0,i=0,a=[1],u=1;u<e.length;u+=1)a.push(e[u-1].size*a[u-1]);for(var f,s,l,c=(f=e.map(function(e){return e.solvedIndexes}),s=[],l=f.length-1,function e(n,t){for(var r=0;r<f[t].length;r+=1){var o=n.slice(0);o.push(f[t][r]),t===l?s.push(o):e(o,t+1)}}([],0),s),h=0;h<c.length;h+=1){for(var v=0,d=0;d<c[h].length;d+=1)v+=a[d]*c[h][d];this.setPruningValue(v,0),i+=1}for(;i!==t;){var m=t/2<i,g=m?15:o,b=m?o:15;o+=1;for(var p=0;p<t;p+=1)if(this.getPruningValue(p)===g)for(var y=0;y<n.length;y+=1){for(var x=n[y],T=p,O=0,w=a.length-1;0<=w;--w)O+=a[w]*e[w].doMove(Math.floor(T/a[w]),x),T%=a[w];if(this.getPruningValue(O)===b){if(i+=1,m){this.setPruningValue(p,o);break}this.setPruningValue(O,o)}}}}}]),t}(),De=function(){function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Me;u(this,t),this.createTables=e,this.moves=n}return e(t,[{key:"initialize",value:function(){var o=this;if(!this.initialized){this.initialized=!0;var e=this.createTables(),n=e.moveTables,t=e.pruningTables;this.moveTables=n,this.pruningTables=[],t.forEach(function(e){var n=e.map(function(e){return o.moveTables.map(function(e){return e.name}).indexOf(e)});n.sort(function(e,n){return o.moveTables[e].size-o.moveTables[n].size});var t=[];n.forEach(function(e){return t.push(o.moveTables[e])});var r=new Ee(t,o.moves);o.pruningTables.push({pruningTable:r,moveTableIndexes:n})})}}},{key:"handleSolution",value:function(e,n){return{solution:e,indexes:n}}},{key:"search",value:function(e,n,t,r){for(var o=0,i=0;i<this.pruningTables.length;i+=1){for(var a=e[this.pruningTables[i].moveTableIndexes[0]],u=1,f=1;f<this.pruningTables[i].moveTableIndexes.length;f+=1)u*=this.moveTables[this.pruningTables[i].moveTableIndexes[f-1]].size,a+=e[this.pruningTables[i].moveTableIndexes[f]]*u;var s=this.pruningTables[i].pruningTable.getPruningValue(a);if(n<s)return!1;o<s&&(o=s)}if(0===o)return this.handleSolution(r,e);if(0<n)for(var l=0;l<this.moves.length;l+=1){var c=this.moves[l];if(Math.floor(c/3)!==Math.floor(t/3)&&Math.floor(c/3)!==Math.floor(t/3)-3){for(var h=[],v=0;v<e.length;v+=1)h.push(this.moveTables[v].doMove(e[v],c));var d=this.search(h,n-1,c,r.concat([c]));if(d)return d}}return!1}},{key:"solve",value:function(e){var t=this;this.initialize(),this.settings=c({maxDepth:22,lastMove:null,format:!0},e);var n,r=this.settings.indexes||[];if(this.settings.scramble){var o=h(T(this.settings.scramble,!0),2),i=o[0],a=o[1];0<a.length&&(n=function(e){if(!x(e))throw new Error("Invalid algorithm provided to algorithm parser");return e.match(/[FRUBLDfrubldxyzMSE][2']?/g).reverse().map(function(e){var n=e.charAt(0),t=fe[e.charAt(1)],r=t-t%3*2+2;return 1==r?"".concat(n,"2"):2==r?"".concat(n,"'"):n}).join(" ")}(a.join(" ")));for(var u=0;u<this.moveTables.length;u+=1)r.push(this.moveTables[u].defaultIndex);i.forEach(function(e){for(var n=0;n<r.length;n+=1)r[n]=t.moveTables[n].doMove(r[n],e)})}for(var f=0;f<=this.settings.maxDepth;f+=1){var s=this.search(r,f,this.settings.lastMove,[]);if(s){if(this.settings.format){var l=O(s.solution);return n?O(T("".concat(n," ").concat(l))):l}return s}}return!1}}]),t}(),je=new De(function(){return{moveTables:[j({name:"EdgePermutation",affected:[4,5,6,7]}),C({name:"EdgeOrientation",affected:[4,5,6,7]})],pruningTables:[["EdgePermutation"],["EdgeOrientation"]]}}),Ie=new De(function(){return{moveTables:[C({name:"EdgeOrientation",affected:[0,1,2,3,4,5,6,7,8,9,10,11]}),j({name:"EdgePermutation",affected:[5,7]})],pruningTables:[["EdgeOrientation"],["EdgePermutation"]]}}),Ce=new De(function(){return{moveTables:[C({name:"EdgeOrientation",affected:[6,9,10]}),F({name:"CornerOrientation",affected:[5,6]}),j({name:"EdgePermutation",affected:[6,9,10]}),D({name:"CornerPermutation",affected:[5,6]})],pruningTables:[["EdgeOrientation","CornerPermutation"],["CornerOrientation","CornerPermutation"],["EdgePermutation","CornerPermutation"]]}}),Fe=[1,10,4,13,6,7,8,15,16,17],Ue=new De(function(){function e(e,n){for(var t=g(e,[0,1,2],12),r=g(n,[3,4,5],12),o=0;o<8;o+=1)if(-1!==t[o]){if(-1!==r[o])return-1;r[o]=t[o]}return m(r,[0,1,2,3,4,5])}ie=[];for(var n=0;n<336;n+=1){ie.push([]);for(var t=0;t<336;t+=1)ie[n][t]=e(n,t)}return{moveTables:[new ze({name:"slicePermutation",size:24,table:oe.table}),te,re,j({name:"URToDF",size:20160,moves:Fe,affected:[0,1,2,3,4,5]})],pruningTables:[["slicePermutation","parity","URFToDLF"],["slicePermutation","parity","URToDF"]]}},Fe),ke=new(function(){function i(){var e,n;u(this,i);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(n=f(this,(e=a(i)).call.apply(e,[this].concat(r)))).maxDepth=22,n.solution=null,n}return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&t(e,n)}(i,De),e(i,[{key:"handleSolution",value:function(e,n){var t=e.slice(-1)[0];if(t%2==0&&6===Math.floor(t/3)&&15===Math.floor(t/3))return!1;var r=Ue.solve({indexes:[n[3],n[4],n[5],ie[n[6]][n[7]]],maxDepth:this.maxDepth-e.length,lastMove:t,format:!1});if(r){if(this.solution=e.concat(r.solution),this.maxDepth<=this.settings.maxDepth)return{solution:this.solution,indexes:n};this.maxDepth=this.solution.length-1}return!1}}]),i}())(function(){return te=new ze({name:"parity",size:2,table:[[1,0,1,1,0,1,1,0,1,1,0,1,1,0,1,1,0,1],[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]]}),re=D({name:"URFToDLF",affected:[0,1,2,3,4,5]}),oe=j({name:"slice",affected:[8,9,10,11],reversed:!0}),Ue.initialize(),{moveTables:[new ze({name:"slicePosition",size:495,table:oe.table,doMove:function(e,n,t){return Math.floor(e[24*n][t]/24)}}),F({name:"twist",affected:[0,1,2,3,4,5,6,7]}),C({name:"flip",affected:[0,1,2,3,4,5,6,7,8,9,10,11]}),oe,te,re,j({name:"URToUL",affected:[0,1,2]}),j({name:"UBToDF",affected:[3,4,5]})],pruningTables:[["slicePosition","flip"],["slicePosition","twist"]]}}),Ae=new De(function(){return{moveTables:[j({name:"EdgePermutation",affected:[4,5,6,7,9]}),C({name:"EdgeOrientation",affected:[4,5,6,7,9]}),D({name:"CornerPermutation",affected:[5]}),F({name:"CornerOrientation",affected:[5]})],pruningTables:[["EdgePermutation","CornerPermutation"],["EdgeOrientation","CornerOrientation"]]}}),Re=new De(function(){return{moveTables:[D({name:"CornerPermutation",affected:[4,5,6,7]}),F({name:"CornerOrientation",affected:[4,5,6,7]})],pruningTables:[["CornerPermutation"],["CornerOrientation"]]}}),Se=new De(function(){return{moveTables:[D({name:"CornerPermutation",affected:[4,5,6,7]}),F({name:"CornerOrientation",affected:[5,6,7]})],pruningTables:[["CornerPermutation"],["CornerOrientation"]]}}),Le=new De(function(){return{moveTables:[F({name:"CornerOrientation",affected:[0,1,2,3,4,5,6,7]})],pruningTables:[["CornerOrientation"]]}}),Ve=[0,1,2,3],Be=[ce,he,ve,de,me,ge],_e=[ce,he,ve,de],$e=[pe,ye,xe,Te],qe=[pe,ye,xe,Te,Oe];return{solve:function(e,n){var t=1<arguments.length&&void 0!==n?n:"kociemba",r={kociemba:R,cross:U,eoline:k,fb:A,xcross:L,pl:V,pt:B,pg:_};if(r[t])return r[t](e);throw new Error("Specified solver does not exist.")},scramble:function(e){var n=0<arguments.length&&void 0!==e?e:"3x3",t={"3x3":K,"2gll":J,cmll:N,corners:Q,edges:W,lse:X,lsll:Y,pll:Z,zbll:ee,zzls:ne};if(t[n])return t[n]();throw new Error("Specified scrambler does not exist.")},initialize:function(e){var n={cross:je,eoline:Ie,fb:Ce,xcross:Ae,pl:Re,pt:Se,pg:Le};if("kociemba"===e)ke.initialize(),Ue.initialize();else{if(!n[e])throw new Error("Specified solver does not exist.");n[e].initialize()}}}});
